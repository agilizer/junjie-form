<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->
<head th:replace="layout/userCenter :: head (title='用户中心更改密码--觅油网用户中心')">
</head>
<body>
	<div id="wrapper">
		<div class="nav-bar-container" th:replace="layout/userCenter :: nav">
		</div>
		<!--.nav-bar-container-->

		<div id="page-wrapper">
			<div class="row">
				<div align="center">
					<h2>更改密码</h2>
				</div>
				<form name="changePasswordForm" id="changePasswordForm" class="form-horizontal">
					<div class="col-xs-12 col-sm-5 col-md-5">
						<div class="form-group">
							<label for="oldPassword" class="col-sm-3 control-label">原密码</label>
							<div class="col-sm-9">
								<input type="password" class="form-control" required="required"
									 id="oldPassword" name="oldPassword"/>
							</div>
						</div>
						<div class="form-group">
							<label for="password" class="col-sm-3 control-label">新密码</label>
							<div class="col-sm-9">
								<input type="password" class="form-control" id="password" minlength="6"
									required="required" name="password"/>
							</div>
						</div>
						<div class="form-group">
							<label for="passwordRepeat" class="col-sm-3 control-label">确认新密码</label>
							<div class="col-sm-9">
								<input type="password" class="form-control" id="passwordRepeat"
									minlength="6" required="required" name="passwordRepeat" />
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-offset-3 col-sm-10">
								<button type="submit" class="btn btn-primary">更新</button>
							</div>
						</div>

					</div>
					
				</form>
			</div>
		</div>
	</div>
	<div th:replace="layout/userCenter :: jsEnd"></div>
	<div th:replace="layout/plugins :: jquery-validation"></div>
	<script type="text/javascript" src="/resources/jsCustom/userInfo/userInfo.js"></script>
	<script type="text/javascript">
		var changePasswordUrl = "/userCenter/updatePassword"
		$(document).ready(function() {
			$("#changePasswordForm").validate({
				submitHandler : function(form) {
					jQuery.ajax({
						type : 'POST',
						url : changePasswordUrl,
						data : $("#changePasswordForm").serialize(),
						success : function(data, textStatus) {
							if(data.success){
								alert("密码更新成功，请重先登录！");
								window.location.href="/logout"
							}else{
								alert("密码更新失败！"+data.errorMsg);
							}
						},
						error : function(XMLHttpRequest, textStatus, errorThrown) {
						}
					});
					return false;
				}
			});
			$.extend($.validator.messages, {
				required: "请填写密码",
				maxlength: $.validator.format("最多 {0} 个字"),
				minlength: $.validator.format("密码最少6位！")
				
			});
		});
	</script>
</body>
</html>